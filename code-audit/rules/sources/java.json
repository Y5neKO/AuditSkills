{
  "language": "Java",
  "framework": "Spring",
  "description": "Java Web框架 HTTP入口点 - 用户可控输入",

  "sources": [
    {
      "name": "spring_request_param",
      "pattern": "@RequestParam",
      "type": "request_param",
      "description": "Spring请求参数注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String getUser(@RequestParam String id)",
        "public String search(@RequestParam(value=\"q\") String query)"
      ]
    },
    {
      "name": "spring_path_variable",
      "pattern": "@PathVariable",
      "type": "path_variable",
      "description": "Spring路径变量注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String getUser(@PathVariable String id)",
        "public String getPost(@PathVariable(\"postId\") long id)"
      ]
    },
    {
      "name": "spring_request_body",
      "pattern": "@RequestBody",
      "type": "request_body",
      "description": "Spring请求体注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String create(@RequestBody User user)",
        "public String update(@RequestBody Map<String, Object> data)"
      ]
    },
    {
      "name": "spring_request_header",
      "pattern": "@RequestHeader",
      "type": "request_header",
      "description": "Spring请求头注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String getAuth(@RequestHeader(\"Authorization\") String auth)"
      ]
    },
    {
      "name": "spring_cookie_value",
      "pattern": "@CookieValue",
      "type": "cookie_value",
      "description": "Spring Cookie值注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String getSession(@CookieValue(\"JSESSIONID\") String sessionId)"
      ]
    },
    {
      "name": "spring_request_attr",
      "pattern": "@RequestAttribute",
      "type": "request_attribute",
      "description": "Spring请求属性注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String getAttr(@RequestAttribute(\"user\") User user)"
      ]
    },
    {
      "name": "spring_model_attr",
      "pattern": "@ModelAttribute",
      "type": "model_attribute",
      "description": "Spring模型属性注解",
      "frameworks": ["spring-boot", "spring-mvc"],
      "examples": [
        "public String submit(@ModelAttribute User user)"
      ]
    },
    {
      "name": "spring_http_servlet_request_getParameter",
      "pattern": "request\\.getParameter\\(",
      "type": "servlet_get_parameter",
      "description": "HttpServletRequest获取参数",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String id = request.getParameter(\"id\")",
        "String name = request.getParameter(\"name\")"
      ]
    },
    {
      "name": "spring_http_servlet_request_getParameterValues",
      "pattern": "request\\.getParameterValues\\(",
      "type": "servlet_get_parameter_values",
      "description": "HttpServletRequest获取多值参数",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String[] values = request.getParameterValues(\"ids\")"
      ]
    },
    {
      "name": "spring_http_servlet_request_getHeader",
      "pattern": "request\\.getHeader\\(",
      "type": "servlet_get_header",
      "description": "HttpServletRequest获取请求头",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String auth = request.getHeader(\"Authorization\")",
        "String token = request.getHeader(\"X-Auth-Token\")"
      ]
    },
    {
      "name": "spring_http_servlet_request_getCookies",
      "pattern": "request\\.getCookies\\(",
      "type": "servlet_get_cookies",
      "description": "HttpServletRequest获取Cookies",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "Cookie[] cookies = request.getCookies()"
      ]
    },
    {
      "name": "spring_http_servlet_request_getInputStream",
      "pattern": "request\\.getInputStream\\(",
      "type": "servlet_get_input_stream",
      "description": "HttpServletRequest获取输入流",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "BufferedReader reader = request.getReader()"
      ]
    },
    {
      "name": "spring_http_servlet_request_getReader",
      "pattern": "request\\.getReader\\(",
      "type": "servlet_get_reader",
      "description": "HttpServletRequest获取Reader",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "BufferedReader reader = request.getReader()"
      ]
    },
    {
      "name": "spring_http_servlet_request_getPathInfo",
      "pattern": "request\\.getPathInfo\\(",
      "type": "servlet_get_path_info",
      "description": "HttpServletRequest获取路径信息",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String pathInfo = request.getPathInfo()"
      ]
    },
    {
      "name": "spring_http_servlet_request_getQueryString",
      "pattern": "request\\.getQueryString\\(",
      "type": "servlet_get_query_string",
      "description": "HttpServletRequest获取查询字符串",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String query = request.getQueryString()"
      ]
    },
    {
      "name": "spring_http_servlet_request_getRequestURI",
      "pattern": "request\\.getRequestURI\\(",
      "type": "servlet_get_request_uri",
      "description": "HttpServletRequest获取请求URI",
      "frameworks": ["spring-boot", "spring-mvc", "servlet"],
      "examples": [
        "String uri = request.getRequestURI()"
      ]
    },
    {
      "name": "struts_text_getText",
      "pattern": "ServletActionContext\\.getRequest\\(\\)\\.getParameter\\(",
      "type": "struts_get_parameter",
      "description": "Struts获取请求参数",
      "frameworks": ["struts"],
      "examples": [
        "String id = ServletActionContext.getRequest().getParameter(\"id\")"
      ]
    },
    {
      "name": "jsf_managed_bean_property",
      "pattern": "@ManagedBean",
      "type": "jsf_managed_bean",
      "description": "JSF托管Bean属性",
      "frameworks": ["jsf"],
      "examples": [
        "@ManagedBean\npublic class UserBean {\n  private String name;"
      ]
    }
  ]
}
