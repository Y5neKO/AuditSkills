{
  "language": "JavaScript",
  "framework": "Express",
  "description": "JavaScript/Node.js HTTP入口点 - 用户可控输入",

  "sources": [
    {
      "name": "express_request_body",
      "pattern": "req\\.body",
      "type": "http_body",
      "description": "Express HTTP请求体 (POST/PUT/PATCH数据)",
      "frameworks": ["express", "nest", "fastify"],
      "examples": [
        "const name = req.body.name",
        "const data = req.body"
      ]
    },
    {
      "name": "express_request_params",
      "pattern": "req\\.params",
      "type": "http_params",
      "description": "Express URL路径参数 (/user/:id)",
      "frameworks": ["express", "nest", "fastify"],
      "examples": [
        "const id = req.params.id",
        "const userId = req.params.userId"
      ]
    },
    {
      "name": "express_request_query",
      "pattern": "req\\.query",
      "type": "http_query",
      "description": "Express URL查询参数 (?name=value)",
      "frameworks": ["express", "nest", "fastify"],
      "examples": [
        "const search = req.query.q",
        "const sort = req.query.sort"
      ]
    },
    {
      "name": "express_request_headers",
      "pattern": "req\\.headers",
      "type": "http_headers",
      "description": "Express HTTP请求头",
      "frameworks": ["express", "nest", "fastify"],
      "examples": [
        "const auth = req.headers.authorization",
        "const token = req.headers['x-auth-token']"
      ]
    },
    {
      "name": "express_request_cookies",
      "pattern": "req\\.cookies",
      "type": "http_cookies",
      "description": "Express Cookie数据",
      "frameworks": ["express", "nest"],
      "examples": [
        "const session = req.cookies.session_id",
        "const token = req.cookies.token"
      ]
    },
    {
      "name": "express_request_file",
      "pattern": "req\\.file",
      "type": "http_file",
      "description": "Express上传的文件",
      "frameworks": ["express", "multer"],
      "examples": [
        "const file = req.file",
        "const filename = req.file.originalname"
      ]
    },
    {
      "name": "express_request_files",
      "pattern": "req\\.files",
      "type": "http_files",
      "description": "Express上传的多个文件",
      "frameworks": ["express", "multer"],
      "examples": [
        "const files = req.files",
        "const file = req.files[0]"
      ]
    },
    {
      "name": "koa_request_body",
      "pattern": "ctx\\.request\\.body",
      "type": "http_body",
      "description": "Koa HTTP请求体",
      "frameworks": ["koa"],
      "examples": [
        "const name = ctx.request.body.name"
      ]
    },
    {
      "name": "koa_request_query",
      "pattern": "ctx\\.query",
      "type": "http_query",
      "description": "Koa URL查询参数",
      "frameworks": ["koa"],
      "examples": [
        "const search = ctx.query.q"
      ]
    },
    {
      "name": "koa_request_params",
      "pattern": "ctx\\.params",
      "type": "http_params",
      "description": "Koa URL路径参数",
      "frameworks": ["koa"],
      "examples": [
        "const id = ctx.params.id"
      ]
    },
    {
      "name": "nest_req_body_decorator",
      "pattern": "@RequestBody\\(\\)",
      "type": "http_body_decorator",
      "description": "NestJS @RequestBody装饰器参数",
      "frameworks": ["nest"],
      "examples": [
        "async create(@Body() createUserDto: CreateUserDto)"
      ]
    },
    {
      "name": "nest_req_param_decorator",
      "pattern": "@Param\\(\\)",
      "type": "http_params_decorator",
      "description": "NestJS @Param装饰器参数",
      "frameworks": ["nest"],
      "examples": [
        "async findOne(@Param('id') id: string)"
      ]
    },
    {
      "name": "nest_req_query_decorator",
      "pattern": "@Query\\(\\)",
      "type": "http_query_decorator",
      "description": "NestJS @Query装饰器参数",
      "frameworks": ["nest"],
      "examples": [
        "async findAll(@Query('page') page: number)"
      ]
    },
    {
      "name": "nextjs_search_params",
      "pattern": "searchParams",
      "type": "http_query",
      "description": "Next.js URL查询参数",
      "frameworks": ["next"],
      "examples": [
        "const searchParams = request.nextUrl.searchParams"
      ]
    },
    {
      "name": "fastify_request_body",
      "pattern": "request\\.body",
      "type": "http_body",
      "description": "Fastify请求体",
      "frameworks": ["fastify"],
      "examples": [
        "const name = request.body.name"
      ]
    },
    {
      "name": "fastify_request_query",
      "pattern": "request\\.query",
      "type": "http_query",
      "description": "Fastify查询参数",
      "frameworks": ["fastify"],
      "examples": [
        "const search = request.query.q"
      ]
    },
    {
      "name": "fastify_request_params",
      "pattern": "request\\.params",
      "type": "http_params",
      "description": "Fastify路径参数",
      "frameworks": ["fastify"],
      "examples": [
        "const id = request.params.id"
      ]
    },
    {
      "name": "hapi_request_payload",
      "pattern": "request\\.payload",
      "type": "http_body",
      "description": "Hapi请求体",
      "frameworks": ["hapi"],
      "examples": [
        "const data = request.payload"
      ]
    },
    {
      "name": "hapi_request_query",
      "pattern": "request\\.query",
      "type": "http_query",
      "description": "Hapi查询参数",
      "frameworks": ["hapi"],
      "examples": [
        "const search = request.query.q"
      ]
    },
    {
      "name": "hapi_request_params",
      "pattern": "request\\.params",
      "type": "http_params",
      "description": "Hapi路径参数",
      "frameworks": ["hapi"],
      "examples": [
        "const id = request.params.id"
      ]
    }
  ]
}
