{
  "scan_date": "2025-02-03",
  "project_name": "SpringBlade",
  "project_type": "Spring Boot 3.5 / Spring Cloud 2025 Microservices",
  "summary": {
    "total_controllers": 28,
    "total_endpoints": 150,
    "protected_endpoints": 85,
    "unprotected_endpoints": 65
  },
  "controllers": [
    {
      "file": "blade-auth/src/main/java/org/springblade/auth/controller/AuthController.java",
      "base_path": "/",
      "endpoints": [
        {
          "method": "POST",
          "path": "/token",
          "description": "获取认证token",
          "line": 55,
          "auth_required": false,
          "parameters": ["grantType", "refreshToken", "tenantId", "account", "password"],
          "sensitive": true
        },
        {
          "method": "GET",
          "path": "/captcha",
          "description": "获取验证码",
          "line": 83,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "POST",
          "path": "/logout",
          "description": "登出",
          "line": 95,
          "auth_required": false,
          "sensitive": false
        }
      ],
      "vulnerabilities": ["WEAK_AUTH_001", "BRUTE_FORCE_001"]
    },
    {
      "file": "blade-auth/src/main/java/org/springblade/auth/controller/SocialController.java",
      "base_path": "/oauth",
      "endpoints": [
        {
          "method": "GET",
          "path": "/render/{source}",
          "description": "授权完毕跳转",
          "line": 54,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "POST",
          "path": "/callback/{source}",
          "description": "获取认证信息",
          "line": 65,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "POST",
          "path": "/revoke/{source}/{token}",
          "description": "撤销授权",
          "line": 75,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "POST",
          "path": "/refresh/{source}",
          "description": "续期令牌",
          "line": 85,
          "auth_required": false,
          "sensitive": true
        }
      ],
      "vulnerabilities": ["OAUTH_001", "SSRF_001"]
    },
    {
      "file": "blade-service/blade-system/src/main/java/org/springblade/system/controller/UserController.java",
      "base_path": "/user",
      "endpoints": [
        {
          "method": "GET",
          "path": "/detail",
          "description": "查看详情",
          "line": 85,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/info",
          "description": "查看详情",
          "line": 97,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/list",
          "description": "列表",
          "line": 106,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/submit",
          "description": "新增或修改",
          "line": 123,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/update",
          "description": "修改",
          "line": 134,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/remove",
          "description": "删除",
          "line": 145,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/grant",
          "description": "权限设置",
          "line": 161,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/reset-password",
          "description": "初始化密码",
          "line": 171,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/update-password",
          "description": "修改密码",
          "line": 188,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "GET",
          "path": "/user-list",
          "description": "用户列表",
          "line": 204,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/import-user",
          "description": "导入用户",
          "line": 217,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "GET",
          "path": "/export-user",
          "description": "导出用户",
          "line": 244,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/export-template",
          "description": "导出模板",
          "line": 266,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "POST",
          "path": "/register-guest",
          "description": "第三方注册用户",
          "line": 281,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "POST",
          "path": "/unlock",
          "description": "账号解锁",
          "line": 292,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/update-info",
          "description": "修改基本信息",
          "line": 308,
          "auth_required": false,
          "sensitive": true
        }
      ],
      "vulnerabilities": ["IDOR_001", "IDOR_002", "AUTHZ_001"]
    },
    {
      "file": "blade-gateway/src/main/java/org/springblade/gateway/controller/DiscoveryClientController.java",
      "base_path": "/discovery",
      "endpoints": [
        {
          "method": "GET",
          "path": "/instances",
          "description": "获取服务实例",
          "line": 46,
          "auth_required": false,
          "sensitive": true
        }
      ],
      "vulnerabilities": ["INFO_DISC_001"]
    },
    {
      "file": "blade-ops/blade-develop/src/main/java/org/springblade/develop/controller/CodeController.java",
      "base_path": "/code",
      "endpoints": [
        {
          "method": "GET",
          "path": "/detail",
          "description": "详情",
          "line": 65,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/list",
          "description": "分页",
          "line": 76,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/submit",
          "description": "新增或修改",
          "line": 92,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/remove",
          "description": "删除",
          "line": 103,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/copy",
          "description": "复制",
          "line": 113,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/gen-code",
          "description": "代码生成",
          "line": 126,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN",
          "sensitive": true
        }
      ],
      "vulnerabilities": ["CODE_INJ_001"]
    },
    {
      "file": "blade-ops/blade-develop/src/main/java/org/springblade/develop/controller/DatasourceController.java",
      "base_path": "/datasource",
      "endpoints": [
        {
          "method": "GET",
          "path": "/detail",
          "description": "详情",
          "line": 55,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/list",
          "description": "分页",
          "line": 66,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/save",
          "description": "新增",
          "line": 77,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/update",
          "description": "修改",
          "line": 87,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/submit",
          "description": "新增或修改",
          "line": 97,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "POST",
          "path": "/remove",
          "description": "删除",
          "line": 109,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/select",
          "description": "下拉数据源",
          "line": 119,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        }
      ],
      "vulnerabilities": ["IDOR_003", "SSRF_002"]
    },
    {
      "file": "blade-service/blade-system/src/main/java/org/springblade/system/controller/TenantController.java",
      "base_path": "/tenant",
      "endpoints": [
        {
          "method": "GET",
          "path": "/detail",
          "description": "详情",
          "line": 64,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/list",
          "description": "分页",
          "line": 74,
          "auth_required": true,
          "role": "HAS_ROLE_ADMIN"
        },
        {
          "method": "GET",
          "path": "/select",
          "description": "下拉数据源",
          "line": 91,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/page",
          "description": "分页",
          "line": 102,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "POST",
          "path": "/submit",
          "description": "新增或修改",
          "line": 112,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "POST",
          "path": "/remove",
          "description": "删除",
          "line": 122,
          "auth_required": false,
          "sensitive": true
        },
        {
          "method": "GET",
          "path": "/info",
          "description": "配置信息",
          "line": 133,
          "auth_required": false,
          "sensitive": false
        }
      ],
      "vulnerabilities": ["AUTHZ_002", "IDOR_004"]
    },
    {
      "file": "blade-service/blade-system/src/main/java/org/springblade/system/controller/MenuController.java",
      "base_path": "/menu",
      "endpoints": [
        {
          "method": "GET",
          "path": "/routes",
          "description": "前端菜单数据",
          "line": 150,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/buttons",
          "description": "前端按钮数据",
          "line": 161,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/auth-routes",
          "description": "菜单的角色权限",
          "line": 211,
          "auth_required": false,
          "sensitive": false
        },
        {
          "method": "GET",
          "path": "/top-menu",
          "description": "顶部菜单数据",
          "line": 224,
          "auth_required": false,
          "sensitive": false
        }
      ],
      "vulnerabilities": ["AUTHZ_003"]
    }
  ],
  "critical_findings": [
    "认证端点/token无需身份验证",
    "社交登录端点/oauth/*无需身份验证",
    "网关服务发现/discovery/instances暴露内部架构",
    "租户管理接口/tenant/submit和/remove无权限保护",
    "用户导入/导出功能可能导致数据泄露"
  ]
}
